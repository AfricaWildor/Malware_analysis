import tool
from source import *
from Visualization import rgb_hil


def detect(path, raw):
	s = Source(raw)
	if s.text_exists:
		print(s.ins_entropy)
	else:
		print(s.shell)
	write_byte(path + '.bytes', s.raw_without_header)
	gen_rgb_hil(path + '.bytes.png', s.raw_without_header)

	# TODO

def write_byte(path, raw):
	tool.write_file(path, raw.hex())


def gen_rgb_hil(path, raw):
	rgb_hil.generate(raw, path)


def get_ins_entropy(raw):
	s = Source(raw)
	if s.text_exists:
		print(s.ins_entropy)
	else:
		print(s.shell)


if __name__ == '__main__':
	path = 'sample/SelectSort.exe'
	raw = tool.read_file(path)
	detect(path, raw)