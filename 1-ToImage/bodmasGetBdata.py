import pandas as pd
import os
import numpy as np


# df = pd.read_csv(r'E:\malware-classification\BODMAS\bodmas_metadata.csv')
# df = df.dropna(axis=0)
# typedict={}
# for index,row in df.iterrows():
#     dictkey=row["family"]
#     if True:
#         typedict.setdefault(dictkey,0)
#         typedict[dictkey] += 1
#创建了统计每个famlily共有n个的字典{familyname:count}

#print (typedict)

#分别统计大于100、500、1000的family
# i=0
# j=0
# k=0
# for itkeys,itvalues in typedict.items():
#     if itvalues > 100:
#         print(itkeys," : ",itvalues)
#         i += 1
#         if itvalues > 500:
#             j += 1
#             if itvalues > 1000:
#                 k += 1
#
# print ("types over 100 :",i)
# print ("types over 500 :",j)
# print ("types over 1000 :",k)
# print ("sum is : ",len(typedict)," types")

orgpath = "E:\\malware-classification\\BODMAS\\BODMAS_disarmed_malware_binaries-001\\IMG2"
tarpath = "E:\\malware-classification\\BODMAS\\BODMAS_disarmed_malware_binaries-001\\b"

##创建以family名为名字的文件夹
# for imgFamily in typedict.keys():
#     if typedict[imgFamily] >= 1:
#         print(imgFamily)
#         try:
#             os.mkdir(os.path.join(tarpath, imgFamily))
#         except:
#             pass

#将图片移动到对应家族
# i = 0
# for index,row in df.iterrows():
#     itemFamily=row["family"]
#     itemSha=row["sha"]
#     if os.path.exists(os.path.join(orgpath, itemSha+".bytes.png")):
#         if os.path.exists(os.path.join(tarpath, itemFamily)):
#             try:
#                 os.rename(
#                     os.path.join(orgpath, itemSha + ".bytes.png"),
#                     os.path.join(tarpath, itemFamily, f"{itemSha}.png")
#                 )
#             except:
#                 pass
#         print("moved",i)
#         i +=1

#使用统计结果，重命名文件夹
# for imgFamily in typedict.keys():
#     if typedict[imgFamily] >= 1:
#         try:
#             os.rename(
#                 os.path.join(tarpath,imgFamily),
#                 os.path.join(tarpath,imgFamily+"_"+str(typedict[imgFamily]))
#             )
#         except:
#             pass

for root, dirs, files in os.walk(r"E:\malware-classification\BODMAS\BODMAS_disarmed_malware_binaries-001\b"):
    if not os.listdir(root):
        os.rmdir(root)
