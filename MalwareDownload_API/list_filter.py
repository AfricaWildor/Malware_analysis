# -*- codeing = utf-8 -*-
from file_get import *



# 标签集，筛选列表，是否开启精确筛选
def tag_filter(tag,list,exact=False):
	if len(tag)==0:
		return sha256_list_get(list)
	else:
		if not exact:
			sha256_list=[]
			for item in list:
				# print(item['tags'])
				flag = True
				for t in tag:#判断标签是否均存在
					if t not in item['tags']:
						flag=False
				if flag:#若标签都存在 则筛选
					sha256_list.append(item['sha256_hash'])

			print(f"filter to {len(sha256_list)} malware with fuzzy tag {tag}")
			return sha256_list
		else:
			sha256_list=[]
			for item in list:
				flag = True
				if len(item['tags'])!=len(tag):#判断标签个数是否一致
					flag=False
				for t in tag:#判断标签是否均存在
					if t not in item['tags']:
						flag=False
				if flag:#若标签都存在且长度一致 说明完全一样 筛选
					sha256_list.append(item['sha256_hash'])

			print(f"filter to {len(sha256_list)} malware with exact tag {tag}")
			return sha256_list



def file_type_filter(file_type,list):
	if file_type=='':
		return sha256_list_get(list)
	else:
		sha256_list=[]
		for item in list:
			# print(item['file_type'])
			if file_type == item['file_type']:
				sha256_list.append(item['sha256_hash'])
		print(f"filter to {len(sha256_list)} malware with filetype {file_type}")
		return sha256_list